{"version":3,"sources":["assets/c2f-framework/hack/EventMgrHack.ts"],"names":[],"mappings":";;;;;AACA,aAAa;;AAEb,IAAI,CAAC,SAAS,EAAE;IACZ,IAAI,EAAE,CAAC,UAAU,CAAC,CAAC,YAAY,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,sBAAsB,CAAC,EAAE;QACrF,EAAE,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,sBAAsB,CAAC,GAAG,IAAI,CAAC;QAE3D,IAAI,cAAY,GAAG,EAAE,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC;QAC/C,EAAE,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,qBAAqB,GAAG,UAAU,QAAQ,EAAE,OAAO;YAC3E,oCAAoC;YACpC,IAAI,CAAC,QAAQ,CAAC,aAAa,EAAE;gBACzB,OAAO,KAAK,CAAC;YAEjB,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,EAAE,QAAQ,GAAG,KAAK,CAAC,YAAY,CAAC;YACzD,KAAK,CAAC,aAAa,GAAG,QAAQ,CAAC,KAAK,CAAC;YAErC,IAAI,SAAS,GAAG,KAAK,EAAE,UAAU,CAAC;YAClC,IAAI,OAAO,GAAG,KAAK,CAAC,YAAY,EAAE,EAAE,UAAU,GAAG,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC;YACrE,IAAI,OAAO,KAAK,UAAU,CAAC,KAAK,EAAE;gBAC9B,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,kBAAkB,IAAI,cAAY,CAAC,aAAa,EAAE;oBAC5D,IAAI,IAAI,GAAG,cAAY,CAAC,qBAAqB,CAAC,KAAK,CAAC;oBACpD,IAAI,IAAI,IAAI,IAAI,CAAC,iBAAiB,IAAI,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE,IAAI,cAAY,CAAC,aAAa,CAAC,GAAG,EAAE;wBACzF,OAAO,KAAK,CAAC;qBAChB;iBACJ;gBACD,IAAI,QAAQ,CAAC,YAAY,EAAE;oBACvB,SAAS,GAAG,QAAQ,CAAC,YAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;oBACnD,IAAI,SAAS,IAAI,QAAQ,CAAC,WAAW,EAAE;wBACnC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;wBACxC,cAAY,CAAC,qBAAqB,GAAG,QAAQ,CAAC;wBAC9C,cAAY,CAAC,aAAa,GAAG,QAAQ,CAAC;qBACzC;iBACJ;aACJ;iBAAM,IAAI,QAAQ,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC;mBACvC,CAAC,CAAC,UAAU,GAAG,QAAQ,CAAC,eAAe,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;gBACvE,SAAS,GAAG,IAAI,CAAC;gBAEjB,IAAI,CAAC,EAAE,CAAC,KAAK,CAAC,kBAAkB,IAAI,cAAY,CAAC,aAAa,IAAI,cAAY,CAAC,aAAa,KAAK,QAAQ,EAAE;oBACvG,OAAO,KAAK,CAAC;iBAChB;gBAED,IAAI,OAAO,KAAK,UAAU,CAAC,KAAK,IAAI,QAAQ,CAAC,YAAY,EAAE;oBACvD,QAAQ,CAAC,YAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;iBAC1C;qBAAM,IAAI,OAAO,KAAK,UAAU,CAAC,KAAK,EAAE;oBACrC,IAAI,QAAQ,CAAC,YAAY;wBACrB,QAAQ,CAAC,YAAY,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;oBAC3C,IAAI,QAAQ,CAAC,WAAW;wBACpB,QAAQ,CAAC,eAAe,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;oBACnD,cAAY,CAAC,cAAc,EAAE,CAAC;iBACjC;qBAAM,IAAI,OAAO,KAAK,UAAU,CAAC,QAAQ,EAAE;oBACxC,IAAI,QAAQ,CAAC,gBAAgB;wBACzB,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;oBAC/C,IAAI,QAAQ,CAAC,WAAW;wBACpB,QAAQ,CAAC,eAAe,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;oBACnD,cAAY,CAAC,cAAc,EAAE,CAAC;iBACjC;aACJ;YAED,6CAA6C;YAC7C,IAAI,KAAK,CAAC,SAAS,EAAE,EAAE;gBACnB,cAAY,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;gBAC1C,OAAO,IAAI,CAAC;aACf;YAED,IAAI,SAAS,IAAI,QAAQ,CAAC,cAAc,EAAE;gBACtC,IAAI,OAAO,CAAC,eAAe;oBACvB,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;gBACxC,OAAO,IAAI,CAAC;aACf;YACD,OAAO,KAAK,CAAC;QACjB,CAAC,CAAC;KAEL;CACJ","file":"","sourceRoot":"/","sourcesContent":["\n//@ts-nocheck\n\nif (!CC_EDITOR) {\n    if (cc['internal'].eventManager && !cc['internal'].eventManager['__$CCEventMgrHack$__']) {\n        cc['internal'].eventManager['__$CCEventMgrHack$__'] = true;\n\n        let eventManager = cc['internal'].eventManager;\n        cc['internal'].eventManager._onTouchEventCallback = function (listener, argsObj) {\n            // Skip if the listener was removed.\n            if (!listener._isRegistered())\n                return false;\n\n            var event = argsObj.event, selTouch = event.currentTouch;\n            event.currentTarget = listener._node;\n\n            var isClaimed = false, removedIdx;\n            var getCode = event.getEventCode(), EventTouch = cc.Event.EventTouch;\n            if (getCode === EventTouch.BEGAN) {\n                if (!cc.macro.ENABLE_MULTI_TOUCH && eventManager._currentTouch) {\n                    let node = eventManager._currentTouchListener._node;\n                    if (node && node.activeInHierarchy && event.touch.getID() != eventManager._currentTouch._id) {\n                        return false;\n                    }\n                }\n                if (listener.onTouchBegan) {\n                    isClaimed = listener.onTouchBegan(selTouch, event);\n                    if (isClaimed && listener._registered) {\n                        listener._claimedTouches.push(selTouch);\n                        eventManager._currentTouchListener = listener;\n                        eventManager._currentTouch = selTouch;\n                    }\n                }\n            } else if (listener._claimedTouches.length > 0\n                && ((removedIdx = listener._claimedTouches.indexOf(selTouch)) !== -1)) {\n                isClaimed = true;\n\n                if (!cc.macro.ENABLE_MULTI_TOUCH && eventManager._currentTouch && eventManager._currentTouch !== selTouch) {\n                    return false;\n                }\n\n                if (getCode === EventTouch.MOVED && listener.onTouchMoved) {\n                    listener.onTouchMoved(selTouch, event);\n                } else if (getCode === EventTouch.ENDED) {\n                    if (listener.onTouchEnded)\n                        listener.onTouchEnded(selTouch, event);\n                    if (listener._registered)\n                        listener._claimedTouches.splice(removedIdx, 1);\n                    eventManager._clearCurTouch();\n                } else if (getCode === EventTouch.CANCELED) {\n                    if (listener.onTouchCancelled)\n                        listener.onTouchCancelled(selTouch, event);\n                    if (listener._registered)\n                        listener._claimedTouches.splice(removedIdx, 1);\n                    eventManager._clearCurTouch();\n                }\n            }\n\n            // If the event was stopped, return directly.\n            if (event.isStopped()) {\n                eventManager._updateTouchListeners(event);\n                return true;\n            }\n\n            if (isClaimed && listener.swallowTouches) {\n                if (argsObj.needsMutableSet)\n                    argsObj.touches.splice(selTouch, 1);\n                return true;\n            }\n            return false;\n        };\n\n    }\n}\n\n\nexport { };"]}