{"version":3,"sources":["assets/c2f-framework/component/ui/scrollList/VirtualList.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["/**\n * 虚拟列表\n */\n\nimport { GameData } from \"../../../../Script/game/GameData\";\nimport EditorTool from \"../../../utils/EditorTool\";\nimport { GroupSource, VLItemGroup } from \"./VLItemGroup\";\nimport { VLTemplate } from \"./VLTemplate\";\nimport VirtualLayout from \"./VirtualLayout\";\n\nconst { ccclass, property, requireComponent, executeInEditMode, disallowMultiple, menu } = cc._decorator;\n@ccclass\n@disallowMultiple\n@executeInEditMode\n@requireComponent(cc.ScrollView)\n@menu(\"c2f/UI/VirtualList\")\nexport default class VirtualList extends cc.Component {\n    @property({ type: VLTemplate, tooltip: CC_DEV && \"列表主容器\" })\n    public main: VLTemplate = null;\n\n    @property({ type: VLItemGroup, tooltip: CC_DEV && \"列表副容器\\n需要分层显示时使用，一般用于降低draw call\" })\n    public others: VLItemGroup[] = [];\n\n    @property({ tooltip: CC_DEV && \"元素节点大小是否一致\\n大小不一致时必须提供calcItemSize接口，且暂不支持grid排版\" })\n    public isFixedSize: boolean = true;\n\n    @property(cc.Node)\n    public emptyTip: cc.Node = null;\n\n    @property({ tooltip: CC_DEV && \"分帧加载间隔，为0时表示不分帧\" })\n    public frameLoadItv: number = 0;\n\n    @property({ tooltip: CC_DEV && \"是否需要处理层级 为true 需要设置subling\" })\n    public isSubling: boolean = false;\n\n    private _scrollView: cc.ScrollView = null;\n    public get scrollView(): cc.ScrollView {\n        if (!this._scrollView) {\n            this._scrollView = this.getComponent(cc.ScrollView);\n        }\n        return this._scrollView;\n    }\n\n    private _layout: VirtualLayout = null;\n    public get layout(): VirtualLayout {\n        if (!this._layout) {\n            this._layout = this.scrollView.content.getComponent(VirtualLayout);\n        }\n        return this._layout;\n    }\n\n    private _argsArr: any[] = [];\n    /** 列表缓存的所有数据 */\n    public get argsArr(): any[] { return this._argsArr; }\n    public set argsArr(v: any[]) {\n        this._argsArr = v;\n        this.layout.rearrange();\n        this.listCntChanged();\n    }\n\n    /** 分帧加载完成回调 */\n    private _frameLoadCb: Function = null;\n    public get frameLoadCb(): Function {\n        return this._frameLoadCb;\n    }\n    public set frameLoadCb(v: Function) {\n        this._frameLoadCb = v;\n    }\n\n    private _calcItemSize: (args: any) => cc.Size = null;\n    /** 根据参数计算元素大小的接口（isFixedSize为false时必须提供） */\n    public get calcItemSize(): (args: any) => cc.Size { return this._calcItemSize; };\n\n    protected onLoad(): void {\n        if (CC_EDITOR) {\n            this.runEditor();\n            return;\n        }\n        if (this.main.templatePrefab || this.main.templateNode) {\n            this.initList();\n        }\n    }\n\n    protected onDestroy(): void {\n        this.main = null;\n        this.others = [];\n        this.emptyTip = null;\n        this._scrollView = null;\n        this._layout = null;\n        this._argsArr = [];\n        this.frameLoadCb = null;\n    }\n\n    public initList() {\n        if (this.layout) {\n            this.layout.onInit(this);\n        }\n    }\n\n    protected resetInEditor(): void {\n        this.runEditor();\n    }\n\n    protected onFocusInEditor(): void {\n        if (this.main) {\n            this.main.resetMainItemChild();\n        }\n    }\n\n    /**\n     * 编辑器模式下的一些设置\n     */\n    private runEditor(): void {\n        if (!CC_EDITOR) {\n            return;\n        }\n        let scrollView = this.getComponent(cc.ScrollView);\n        let layout = scrollView.content.getComponent(VirtualLayout);\n        if (!this.main.content) {\n            this.main.content = scrollView.content;\n        }\n        if (!layout) {\n            scrollView.content.addComponent(VirtualLayout);\n        }\n        this.main.editorCall = (mainItemChild: unknown, refresh: boolean): void => {\n            let hasChildType = false;\n            for (let i = 0; i < this.others.length; i++) {\n                if (this.others[i].templateType === GroupSource.MAIN_ITEM_CHILD) {\n                    hasChildType = true;\n                    break;\n                }\n            }\n            if (hasChildType) {\n                EditorTool.setClassAttrPropEnum(VLItemGroup, \"templateChild\", cc.Enum[\"getList\"](mainItemChild));\n                if (refresh) {\n                    EditorTool.refreshSelectedInspector(this.node);\n                }\n            }\n        };\n        if (this.main) {\n            this.main.resetMainItemChild();\n        }\n    }\n\n    /** 列表个数变更 */\n    private listCntChanged() {\n        let count = this.argsArr.length;\n        if (this.emptyTip) {\n            this.emptyTip.active = count <= 0;\n        }\n    }\n\n    /**\n     * 滚动元素节点到view的指定位置\n     * @param idx 元素下标\n     * @param itemAnchor 元素的锚点位置（左下角为0点）\n     * @param viewAnchor view的锚点位置（左下角为0点）\n     * @param t 时间 s\n     * @param a 加速度是否衰减，为true且滚动距离大时滚动会不准确\n     */\n    public scrollItemToView(idx: number, itemAnchor: cc.Vec2 = cc.v2(), viewAnchor: cc.Vec2 = cc.v2(), t: number = 0, a: boolean = true): void {\n        this.scrollView.scrollToOffset(this.layout.getScrollOffset(idx, itemAnchor, viewAnchor), t, a);\n    }\n\n    /**\n     * 滚动到视图顶部\n     */\n    public scrollToTop(timeInSecond: number = 0, attenuated: boolean = true): void {\n        this.scrollView.scrollToTop(timeInSecond, attenuated);\n    }\n\n    /**\n     * 滚动到视图底部\n     */\n    public scrollToBottom(timeInSecond: number = 0, attenuated: boolean = true): void {\n        this.scrollView.scrollToBottom(timeInSecond, attenuated);\n    }\n\n    /**\n     * 滚动到视图左部\n     */\n    public scrollToLeft(timeInSecond: number = 0, attenuated: boolean = true): void {\n        this.scrollView.scrollToLeft(timeInSecond, attenuated);\n    }\n\n    /**\n     * 滚动到视图右部\n     */\n    public scrollToRight(timeInSecond: number = 0, attenuated: boolean = true): void {\n        this.scrollView.scrollToRight(timeInSecond, attenuated);\n    }\n\n    /**\n     * 根据参数计算元素大小的接口（isFixedSize为false时必须提供）\n     */\n    public setCalcItemSize(call: (args: any) => cc.Size): void {\n        this._calcItemSize = call;\n    }\n\n    /**\n     * 立即更新布局\n     */\n    public forceUpdate(): void {\n        this.layout.forceUpdate();\n    }\n\n    /**\n     * 刷新所有激活的item\n     */\n    public refreshAllItems(): void {\n        this.layout.refreshAllItems();\n    }\n\n    /** 刷新列表数据 */\n    public refreshAllWithData(v: any[]) {\n        let curCnt = this._argsArr.length;\n        if (curCnt > 0 && curCnt == v.length && this.isFixedSize) {\n            this._argsArr = v;\n            this.layout.resetAllItemData();\n            this.listCntChanged();\n        } else {\n            this.argsArr = v;\n        }\n    }\n\n    /**\n     * 重置某个元素数据\n     * @param index \n     * @param args 元素所需参数\n     */\n    public reset(index: number, args: any): void {\n        if (c2f.utils.math.inRange(0, this._argsArr.length - 1, index)) {\n            this._argsArr[index] = args;\n            this.layout.rearrange();\n        }\n    }\n\n    /**\n     * 添加元素数据到尾部\n     * @param args 元素所需参数\n     */\n    public push(args: any): number {\n        let result = this._argsArr.push(args);\n        this.layout.rearrange(false);\n        this.listCntChanged();\n        return result;\n    }\n\n    /**\n     * 删除尾部元素数据\n     */\n    public pop(): any {\n        let result = this._argsArr.pop();\n        this.layout.rearrange();\n        this.listCntChanged();\n        return result;\n    }\n\n    /**\n     * 添加元素数据到头部\n     * @param args \n     */\n    public unshift(args: any): number {\n        let result = this._argsArr.unshift(args);\n        this.layout.rearrange();\n        this.listCntChanged();\n        return result;\n    }\n\n    /**\n     * 删除头部元素数据\n     */\n    public shift(): any {\n        let result = this._argsArr.shift();\n        this.layout.rearrange();\n        this.listCntChanged();\n        return result;\n    }\n\n    /**\n     * 插入或删除元素 用法同数组splice\n     */\n    public splice(start: number, deleteCount: number, argsArr: any[]): any[] {\n        let result: any[];\n        if (deleteCount === undefined) {\n            result = this._argsArr.splice(start);\n        } else {\n            if (argsArr === undefined || argsArr.length === 0) {\n                result = this._argsArr.splice(start, deleteCount);\n            } else {\n                result = this._argsArr.splice(start, deleteCount);\n                for (let i = 0; i < argsArr.length; i++) {\n                    this._argsArr.splice(start + i, 0, argsArr[i]);\n                }\n            }\n        }\n        this.layout.rearrange();\n        this.listCntChanged();\n        return result;\n    }\n\n    /**\n     * 数据排序\n     * @param call \n     */\n    public sort(call: (a: any, b: any) => number): any[] {\n        let result = this._argsArr.sort(call);\n        this.layout.rearrange();\n        return result;\n    }\n\n    /**\n     * 数据过滤\n     */\n    public filter(call: (value: any, index: number, array: any[]) => boolean): any[] {\n        this._argsArr = this._argsArr.filter(call);\n        this.layout.rearrange();\n        this.listCntChanged();\n        return this._argsArr;\n    }\n\n    /** 列表是否在底部 */\n    public scrollIsInBottom() {\n        let inBottom = false;\n        let lastIdx = this._argsArr.length - 1;\n        let find = this.layout.findIdxIsInView(lastIdx);\n        if (this.canScroll()) {\n            inBottom = find;\n        }\n        return inBottom;\n    }\n\n    /** 可否滚动 */\n    public canScroll() {\n        let can = false;\n        let content = this.scrollView.content;\n        if (this.scrollView.vertical) {\n            can = content.height >= content.parent.height;\n        } else {\n            can = content.width >= content.parent.width;\n        }\n        return can;\n    }\n}\n"]}