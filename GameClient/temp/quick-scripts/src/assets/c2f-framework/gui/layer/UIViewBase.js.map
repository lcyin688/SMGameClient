{"version":3,"sources":["assets/c2f-framework/gui/layer/UIViewBase.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { C2FConst } from '../../define/C2FConst';\nimport { C2FEnum } from '../../define/C2FEnum';\nimport { UIPrefabBase } from './UIPrefabBase';\n\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport class UIViewBase extends UIPrefabBase {\n\n    //--------------UI对象-------------    \n    /** 黑色底板 */\n    private blackBg: cc.Node = null;\n    /** 界面根节点 */\n    private nodeUI: cc.Node = null;\n    //---------------------------------\n\n    /** 正在播放出(入)特效 */\n    private _animaPlaying: boolean = false;\n    public get animaPlaying(): boolean {\n        return this._animaPlaying;\n    }\n    public set animaPlaying(v: boolean) {\n        this._animaPlaying = v;\n    }\n\n    protected onLoad() {\n        super.onLoad();\n        this.initCommonUI();\n    }\n\n    protected onDestroy() {\n        this.blackBg = null;\n        this.nodeUI = null;\n        super.onDestroy();\n    }\n\n    protected initProperty() {\n        this.blackBg = cc.find('blackBg', this.node);\n        this.nodeUI = cc.find('nodeUI', this.node);\n    }\n\n    protected initCommonUI() {\n        if (this.blackBg) {\n            this.blackBg.opacity = 0;\n        }\n        if (this.nodeUI) {\n            this.nodeUI.opacity = 0;\n        }\n    }\n\n    protected playInAnima() {\n        const offsetY = -50;\n        const upHeight = 10;\n        const duration = 0.3;\n        const delayDur = 0.02;\n        this.animaPlaying = true;\n\n        if (this.blackBg) {\n            cc.tween(this.blackBg)\n                .delay(delayDur)\n                .set({ opacity: 127 })\n                .to(duration, { opacity: C2FConst.UIBgOpacity })\n                .start()\n        }\n        if (this.nodeUI) {\n            cc.tween(this.nodeUI)\n                .delay(delayDur)\n                .call(() => {\n                    this.nodeUI.opacity = 0;\n                    this.nodeUI.setPosition(0, offsetY, 0);\n                })\n                .by(duration / 2, { position: cc.v3(0, -offsetY + upHeight, 0), opacity: 125 })\n                .by(duration / 2, { position: cc.v3(0, -upHeight, 0), opacity: 130 })\n                .call(() => {\n                    this.emit(C2FEnum.Event.PopViewInAnimaCmpl);\n                })\n                .start();\n        }\n        if (this.blackBg || this.nodeUI) {\n            this.scheduleOnce(() => {\n                this.animaPlaying = false;\n            }, duration + delayDur)\n        } else {\n            this.animaPlaying = false;\n        }\n    }\n\n    protected playOutAnima(params: any, nextFunc: Function) {\n        const offsetY = -100;\n        const duration = 0.2;\n        this.animaPlaying = true;\n\n        if (this.nodeUI) {\n            cc.tween(this.nodeUI)\n                .by(duration, { position: cc.v3(0, offsetY, 0), opacity: -255 })\n                .start();\n        }\n        if (this.blackBg) {\n            cc.tween(this.blackBg)\n                .to(duration, { opacity: 0 })\n                .start()\n        }\n        let animaEnd = () => {\n            this.animaPlaying = false;\n            nextFunc && nextFunc();\n        }\n        if (this.nodeUI || this.blackBg) {\n            this.scheduleOnce(animaEnd, duration)\n        } else {\n            animaEnd && animaEnd();\n        }\n    }\n\n    protected onEnable() {\n        if (super.onEnable) {\n            super.onEnable();\n        }\n        this.on(C2FEnum.Event.ChangeViewValue, this.onChangeViewValue, this);\n    }\n\n    protected onDisable() {\n        if (super.onDisable) {\n            super.onDisable();\n        }\n        this.off(C2FEnum.Event.ChangeViewValue);\n    }\n\n    /**\n     * \n     * @param msgType 消息类型\n     * @param varName 变量名\n     * @param cb 处理函数\n     */\n    private onChangeViewValue(msgType: string, varName: string, cb: Function) {\n        cb?.(this[varName]);\n    }\n}\n"]}