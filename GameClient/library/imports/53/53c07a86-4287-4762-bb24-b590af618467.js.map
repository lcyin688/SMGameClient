{"version":3,"sources":["assets/entrance/script/platform/PlatManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GameConsts } from \"../../../Script/game/GameConsts\";\nimport { GameHelper } from \"../../../Script/game/GameHelper\";\nimport { EventDispatcher } from \"../../../c2f-framework/core/event/EventDispatcher\";\nimport { PlatBase } from \"./PlatBase\";\nimport { PlatHuanyu } from \"./PlatHuanyu\";\nimport { PlatKuaihan } from \"./PlatKuaihan\";\nimport { PlatHaidx } from \"./PlatHaidx\";\nimport { PlatNoPlat } from \"./PlatNoPlat\";\n\nconst PLAT_DEV: string = 'kh_web';\nconst PLAT_Huanyu: string = 'huanyu';\nconst PLAT_Sanjiu: string = 'sanjiu';\nconst Plat_Kuaihan: string = 'kuaihan';\nconst Plat_Haidx: string = 'haidx';\n\nclass PlatManager extends EventDispatcher {\n    //平台标志\n    private platFlag: string;\n    //当前平台\n    private current: PlatBase;\n    //提审状态\n    private _isAudit: boolean;\n    public get isAudit(): boolean {\n        return this._isAudit;\n    }\n    public set isAudit(v: boolean) {\n        this._isAudit = v;\n    }\n    //http协议加解密KEY\n    private _httpRc4Key: string;\n    public get httpRc4Key(): string {\n        return this._httpRc4Key;\n    }\n    public set httpRc4Key(v: string) {\n        this._httpRc4Key = v;\n    }\n\n\n    constructor() {\n        super();\n        this.current = null;\n        this.isAudit = false;\n        this.httpRc4Key = undefined;\n        this.platFlag = c2f.storage.getPlainItem(GameConsts.PlatNameKey, PLAT_DEV);\n    }\n\n    /** 静态成员 */\n    private static _instance: PlatManager = null\n    public static getInstance(): PlatManager {\n        if (!this._instance) {\n            this._instance = new PlatManager();\n        }\n        return this._instance;\n    }\n\n    /** 初始化 */\n    public init() {\n        if (!this.current) {\n            this.createCurPlat();\n            this.current.loadPlatCfg();\n        }\n    }\n\n    /** 当前平台 */\n    private createCurPlat() {\n        switch (this.platFlag) {\n            case PLAT_DEV:\n                this.current = new PlatNoPlat();\n                break;\n            case PLAT_Huanyu:\n            case PLAT_Sanjiu:\n                this.current = new PlatHuanyu();\n                break;\n            case Plat_Kuaihan:\n                this.current = new PlatKuaihan();\n                break;\n            case Plat_Haidx:\n                this.current = new PlatHaidx();\n                break;\n            default:\n                break;\n        }\n    }\n\n    /** 初始化SDK */\n    public initSDK() {\n        if (!this.current) {\n            return;\n        }\n        if (this.current.sdkInitSuc) {\n            return;\n        }\n        this.current.initSDK(null);\n    }\n\n    /** sdk登录 */\n    public sdkLogin() {\n        if (!this.current) {\n            return;\n        }\n        this.current.login();\n    }\n\n    /** sdk切换账号 */\n    public sdkSwitchAccount() {\n        if (!this.current) {\n            return;\n        }\n        this.current.switchAccount();\n    }\n\n    /** sdk登出 */\n    public sdkLogout() {\n        if (!this.current) {\n            return;\n        }\n        this.current.logout();\n    }\n\n\n\n    /** 更新玩家信息 */\n    public updatePlayerInfo(info: any) {\n        if (!this.current) {\n            return;\n        }\n        this.current.updatePlayerInfo(info);\n    }\n\n    /** 上传信息 */\n    public submitInfo(tag: string, ext?: any) {\n        if (!this.current) {\n            return;\n        }\n        this.current.submitInfo(tag, ext);\n    }\n\n    /** 退出游戏 */\n    public exitGame() {\n        if (!this.current) {\n            return;\n        }\n        if (this.current.supportQuitGame) {\n            this.current.quitGame();\n        } else {\n            //TODO:显示游戏退出确认界面\n        }\n    }\n\n    /** 分享游戏 */\n    public gameShare() {\n        if (!this.current) {\n            return;\n        }\n        this.current.share();\n    }\n\n    /** 显示用户协议 */\n    public showPrivacyPolicy() {\n        if (!this.current) {\n            return;\n        }\n        this.current.showPrivacyPolicy('');\n    }\n\n    /** 初始化bugly */\n    public initBugly() {\n        if (!this.current || this.isAudit) {\n            return;\n        }\n        this.current.initBugly();\n    }\n\n    /** 初始化bugly */\n    public buglySetUserId(str: string) {\n        if (!this.current || this.isAudit) {\n            return;\n        }\n        this.current.buglySetUserId(str);\n    }\n\n    /** bugly 版本 */\n    public setAppVersion(str: string) {\n        if (!this.current || this.isAudit) {\n            return;\n        }\n        this.current.setAppVersion(str);\n    }\n\n    /** 支持用户中心 */\n    public isSuportUserCenter() {\n        if (this.current) {\n            return this.current.supportAccountCenter;\n        } else {\n            return false;\n        }\n    }\n\n    /** 支持faceboss */\n    public isSuportFacebook() {\n        if (this.current) {\n            return this.current.supportFacebook;\n        } else {\n            return false;\n        }\n    }\n\n    /** 显示国内政策相关UI */\n    public needShowPoliciesUI() {\n        if (this.current) {\n            return this.current.showPolicies;\n        } else {\n            return false;\n        }\n    }\n\n    /** 是否需要用户协议 */\n    public needUserAgreement() {\n        if (this.current) {\n            return this.current.showUserAgreement;\n        } else {\n            return false;\n        }\n    }\n\n    //用户中心/联系客服\n    public showAccountCenter() {\n        if (!this.current) {\n            return;\n        }\n        this.current.openAccountCenter();\n    }\n\n    /** 获取游戏账号信息 */\n    public getSdkAccountInfo() {\n        if (!this.current) {\n            return;\n        }\n        return this.current.accoutInfo;\n    }\n\n    /** 获取平台配置 */\n    public getPlatCfg() {\n        if (!this.current) {\n            return;\n        }\n        return this.current.platCfg;\n    }\n\n    /** 获取设备信息 */\n    public getPhoneInfo() {\n        if (!this.current) {\n            return;\n        }\n        return this.current.phoneInfo;\n    }\n\n    /** 获取用户平台账号信息 */\n    public getAccountInfo() {\n        if (!this.current) {\n            return;\n        }\n        return this.current.accoutInfo;\n    }\n\n    /** 显示开发者面板 */\n    public showDevUI() {\n        if (this.current) {\n            return this.current.showDevUI();\n        } else {\n            return false;\n        }\n    }\n\n    /** 拷贝文本到剪贴板 */\n    public copyToClipboard(txt: string) {\n        if (!this.current) {\n            return;\n        }\n        return this.current.copyToClipboard(txt);\n    }\n\n    /** 无发行渠道(白包模式) */\n    public isNoPublishingPlat() {\n        let result = true;\n        if (this.current) {\n            result = this.current.platCfg.sdkFlag == 'sl.normal';\n        }\n        return result;\n    }\n\n    /** SDK是否初始化成功 */\n    public sdkIsInited() {\n        let result = false;\n        if (this.current) {\n            result = this.current.sdkInitSuc;\n        }\n        return result;\n    }\n\n    /** 获取超级VIP状态 */\n    public vipStateIsSubmit(): boolean {\n        if (!this.current) {\n            return;\n        }\n        let ret = this.current.getOtherByFlag('vipState');\n        return Number(ret) > 0;\n    }\n\n    /** 提交超级VIP信息 */\n    public submitVipInfo() {\n        if (!this.current) {\n            return;\n        }\n        this.current.sumbitVipInfo();\n    }\n\n    /** 跳转评分 */\n    public toAppStroeScore() {\n        if (!this.current) {\n            return;\n        }\n        this.current.toAppStroeScore();\n    }\n\n\n\n    /** App版本号 */\n    public getAppVersion() {\n        let version = 'unknown';\n        if (this.current) {\n            version = this.current.appVersion;\n        }\n        return version;\n    }\n\n    /** 热更资源版本 */\n    public getResVersion() {\n        let version = 'unknown';\n        if (this.current) {\n            let ret = GameHelper.compareVersion(this.current.appVersion, this.current.resVersion);\n            if (ret > 0) {\n                version = this.current.appVersion;\n            } else {\n                version = this.current.resVersion;\n            }\n        }\n        return version;\n    }\n\n    /** 安全区域·主要针对H5 */\n    public getSafeArea() {\n        // let szView = cc.view.getVisibleSize();\n        // return { x: 0, y: 0, width: szView.width, height: szView.height - 100 };\n        return null;\n    }\n}\n\ndeclare global {\n    interface ISZG {\n        plat: PlatManager;\n    }\n}\n\nszg.plat = PlatManager.getInstance();\nexport { };"]}