{"version":3,"sources":["assets/boxGame/script/BoxGameMain/BoxGameMain.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UIVControlBase } from './../../../c2f-framework/gui/layer/UIVControlBase';\nimport { C2FEnum } from './../../../c2f-framework/define/C2FEnum';\nimport BoxGameMainModel from './BoxGameMainModel';\nimport BoxGameMainView from './BoxGameMainView';\nimport CountdownLabel from '../../../c2f-framework/component/common/CountdownLabel';\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport default class BoxGameMain extends UIVControlBase {\n    /** 预制名 给实例调用 */\n    public prefabName = 'F_BoxGameMain';\n\n    public model: BoxGameMainModel = undefined;\n    public view: BoxGameMainView = undefined;\n\n    protected onViewOpen(param: any) {\n        this.model.initData()\n        this.loginToGame()\n\n\n    }\n\n    private loginToGame() {\n        c2f.gui.showLoading();\n        let url = this.model.baseUrl + '/pddgame/login'\n        let data = JSON.stringify({\n            ksCode: this.model.accounts[0],\n            test: !0\n        });\n        this.model.sendMsg(url, (dataOut: msgBoxGame.GW_Login) => {\n            this.model.playerData = dataOut\n            this.reflashView()\n            this.model.getWsUrl(dataOut.token, (reason: string) => {\n                c2f.gui.hideLoading();\n                if (reason === \"Connected\") {\n                    let dataTemp = '{\"protocol\":\"json\", \"version\":1}'\n                    this.model.client.tcpSend(dataTemp)\n                } else {\n                    c2f.gui.notifyTxt('1006');\n                    c2f.net.purge();\n                }\n            })\n\n        }, data, 'POST')\n    }\n\n    protected onEnable(): void {\n        if (super.onEnable) {\n            super.onEnable();\n        }\n        this.on(C2FEnum.UIEvent.ButtonClick, this.onButtonClick, this);\n    }\n\n    protected onDisable(): void {\n        if (super.onDisable) {\n            super.onDisable();\n        }\n        this.off(C2FEnum.UIEvent.ButtonClick);\n    }\n\n    private async onButtonClick(eventType: string, component: cc.Button) {\n        switch (component.name) {\n\n            case this.view.btnCloseButton.name:\n                this.CC_onClickbtnClose();\n                break;\n\n            case this.view.btnStartButton.name:\n                this.CC_onClickbtnStart();\n                break;\n\n            case this.view.boxBtnButton.name:\n                this.CC_onClickboxBtn();\n                break;\n\n\n            default:\n                break;\n        }\n    }\n\n    private CC_onClickbtnClose() {\n        this.closeView()\n    }\n\n    private CC_onClickbtnStart() {\n        this.startGame()\n    }\n\n    private reflashView() {\n        let endTs = this.model.playerData.endTime\n        let tsNow = c2f.utils.date.getLocalTick();\n        let sec = endTs - tsNow;\n        this.setTimeCountDownScore(this.view.txt_timeCountdownLabel, sec)\n        this.setNowMoney()\n        this.setNowDimond()\n        this.setNowCoin()\n        this.setNowCash()\n        this.setLevel()\n        this.setStartCount()\n        this.setAdCount()\n        this.setGameRet()\n\n    }\n    private setGameRet() {\n        if (this.model.playerData.gameRet.isOver) {\n            this.view.less.active = true\n            this.setLessCount()\n\n\n\n        }\n\n    }\n    private setNowMoney() {\n        this.view.txt_1Label.string = this.model.playerData.nowMoney.toString()\n    }\n    private setNowDimond() {\n        this.view.txt_count1Label.string = this.model.playerData.nowDiamond.toString()\n    }\n    private setNowCoin() {\n        this.view.txt_count2Label.string = this.model.playerData.nowCoin.toString()\n    }\n\n    private setNowCash() {\n        this.view.txt_count3Label.string = this.model.playerData.nowCash.toString()\n    }\n\n    private setLevel() {\n        this.view.txt_levelLabel.string = this.model.playerData.gameLevel.toString()\n    }\n\n    private setAdCount() {\n        this.view.txt_adLabel.string = this.model.playerData.boxAdLuckTimes.toString()\n    }\n\n    private setStartCount() {\n        this.view.txt_startCountLabel.string = this.model.playerData.timeBoxs.toString()\n    }\n\n    private setLessCount() {\n        this.view.txt_lessLabel.string = this.model.playerData.gameRet.coinNum.toString()\n    }\n    /**倒计时显示 */\n    private setTimeCountDownScore(countdownLabel: CountdownLabel, interval: number) {\n        let dayStr = \"%{d}\" + c2f.language.words(3001) + \"%{hh}:%{mm}:%{ss}\";\n        countdownLabel.startCountdown(interval, {\n            S: \"%{hh}:%{mm}:%{ss}\",\n            M: \"%{hh}:%{mm}:%{ss}\",\n            H: \"%{hh}:%{mm}:%{ss}\",\n            D: dayStr\n        }, c2f.language.words(3000), null, () => {\n        });\n    }\n\n    /**点击开宝箱 看广告 */\n    private CC_onClickboxBtn() {\n        this.clickAd(1)\n\n\n\n\n    }\n\n    private clickAd(typ: number) {\n        let url = this.model.baseUrl + '/pddgame/viewad'\n        let data = JSON.stringify({\n            operType: typ,\n        });\n        this.model.sendMsg(url, (dataOut: any) => {\n\n\n\n        }, data, 'POST')\n    }\n\n\n    private startGame() {\n        let url = this.model.baseUrl + '/pddgame/timebox'\n        this.model.sendMsg(url, (dataOut: any) => {\n\n        }, null, 'POST')\n    }\n\n    private luckGame(typ: number) {\n        let url = this.model.baseUrl + '/pddgame/luck'\n        let data = JSON.stringify({\n            luckType: typ,\n        });\n\n        this.model.sendMsg(url, (dataOut: any) => {\n\n        }, data, 'POST')\n    }\n\n\n}"]}