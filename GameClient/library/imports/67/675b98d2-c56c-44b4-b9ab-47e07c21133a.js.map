{"version":3,"sources":["assets/c2f-framework/component/ui/button/ButtonLongPress.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property, menu, requireComponent } = cc._decorator;\n\n/**\n * 长按按钮\n */\n@ccclass\n@requireComponent(cc.Button)\n@menu(\"c2f/UI/ButtonLongPress\")\nexport default class ButtonLongPress extends cc.Component {\n\n    @property({ tooltip: '触发间隔时间' })\n    touchInterval: number = 0.1;\n\n    @property({ type: cc.Component.EventHandler, tooltip: \"触发事件\" })\n    private triggerHander: cc.Component.EventHandler[] = [];\n\n    private _counter: number = 0;\n    private _isTouching: boolean = false;\n\n    protected onLoad(): void {\n        this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchStart, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancle, this);\n    }\n\n    protected onDisable() {\n        this.stop();\n    }\n\n    private _onTouchStart(evt) {\n        if (this._isTouching) {\n            return\n        };\n        let btn = this.node.getComponent(cc.Button);\n        if (btn && !btn.interactable) {\n            return;\n        }\n        this._counter = 0;\n        this._isTouching = true;\n        this.schedule(this.triggerOnce, this.touchInterval);\n    }\n\n    private _onTouchEnd(evt) {\n        if (this._counter == 0 && this._isTouching) {\n            cc.Component.EventHandler.emitEvents(this.triggerHander, evt);\n        }\n        this.stop();\n    }\n\n    private _onTouchCancle(evt) {\n        this.stop();\n    }\n\n    private triggerOnce(evt) {\n        if (this._isTouching) {\n            this._counter++;\n            cc.Component.EventHandler.emitEvents(this.triggerHander, evt);\n        }\n    }\n\n    private stop() {\n        this._counter = 0;\n        this._isTouching = false;\n        this.unschedule(this.triggerOnce);\n    }\n\n    /** 快捷设置触发处理方法 */\n    public quickSetTriggerHnadler(ower: cc.Component, handlerName: string) {\n        this.triggerHander = [];\n        let handler = new cc.Component.EventHandler();\n        handler.target = ower.node;\n        handler.component = c2f.utils.view.getComponentName(ower);\n        handler.handler = handlerName;\n        handler.customEventData = \"\";\n        this.triggerHander.push(handler);\n    }\n}\n"]}