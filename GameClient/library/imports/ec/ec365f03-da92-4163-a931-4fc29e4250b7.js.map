{"version":3,"sources":["assets/c2f-framework/gui/layer/UIPTouchBase.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { UIPControlBase } from \"./UIPControlBase\";\n\n/** 点击事件回调定义 */\ntype TouchHandler = (event: cc.Event.EventTouch, target: UIPTouchBase) => void;\n\n/** 拖动状态 */\nexport enum MoveState {\n    normal = 1,\n    moveOut = 2,\n    moveIn = 3,\n    disable = 4,\n}\n\nconst { ccclass, property } = cc._decorator;\n@ccclass\nexport default class UIPTouchBase extends UIPControlBase {\n\n    private startHandler: TouchHandler = null;\n    private moveHandler: TouchHandler = null;\n    private endHandler: TouchHandler = null;\n    private cancelHander: TouchHandler = null;\n\n    /** 是否可拖动 */\n    private _canDrag: boolean;\n    public get canDrag(): boolean {\n        return this._canDrag;\n    }\n    public set canDrag(v: boolean) {\n        this._canDrag = v;\n    }\n\n    /** 是否可拖入 */\n    private _canDragIn: boolean;\n    public get canDragIn(): boolean {\n        return this._canDragIn;\n    }\n    public set canDragIn(v: boolean) {\n        this._canDragIn = v;\n    }\n\n    /** 拖出区域节点 */\n    private _dragFrom: cc.Node;\n    public get dragFrom(): cc.Node {\n        return this._dragFrom || this.node;\n    }\n    public set dragFrom(v: cc.Node) {\n        this._dragFrom = v;\n    }\n\n    /** 拖入区域节点 */\n    private _dragIn: cc.Node;\n    public get dragIn(): cc.Node {\n        return this._dragIn || this.node;\n    }\n    public set dragIn(v: cc.Node) {\n        this._dragIn = v;\n    }\n\n    /** 是否发生拖动 */\n    private _didDragMove: boolean = false;\n    public get didDragMove(): boolean {\n        return this._didDragMove;\n    }\n    public set didDragMove(v: boolean) {\n        this._didDragMove = v;\n    }\n\n    protected onDestroy(): void {\n        this.startHandler = null;\n        this.moveHandler = null;\n        this.endHandler = null;\n        this.cancelHander = null;\n        this.dragFrom = null;\n        this.dragIn = null;\n        super.onDestroy();\n    }\n\n    protected onEnable(): void {\n        if (super.onEnable) {\n            super.onEnable();\n        }\n        // 监听触摸事件\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this);\n    }\n\n    protected onDisable(): void {\n        if (super.onDisable) {\n            super.onDisable();\n        }\n        this.node.off(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.off(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\n        this.node.off(cc.Node.EventType.TOUCH_CANCEL, this.onTouchCancel, this);\n    }\n\n\n    /** 判断是否拖入 */\n    public checkIsMoveIn(posW: cc.Vec2) {\n        let result = false;\n        if (this.canDragIn) {\n            let toBox = this.dragIn.getBoundingBox();\n            let curPosL = this.node.parent.convertToNodeSpaceAR(posW);\n            result = toBox.contains(curPosL);\n        }\n        return result;\n    }\n\n    /** 拖动事件 */\n    public setTouchHandler(startHandler: TouchHandler, moveHandler: TouchHandler, endHandler: TouchHandler, cancelHander: TouchHandler) {\n        this.startHandler = startHandler;\n        this.moveHandler = moveHandler;\n        this.endHandler = endHandler;\n        this.cancelHander = cancelHander;\n    }\n\n    private onTouchStart(event: cc.Event.EventTouch): void {\n        if (!this.canDrag) {\n            return;\n        }\n        let fromBox = this.dragFrom.getBoundingBox();\n        let curPosW = event.getLocation();\n        let curPosL = this.node.parent.convertToNodeSpaceAR(curPosW);\n        if (!fromBox.contains(curPosL)) {\n            return;\n        }\n        this.didDragMove = false;\n        this.startHandler && this.startHandler(event, this);\n    }\n\n    private onTouchMove(event: cc.Event.EventTouch): void {\n        this.didDragMove = true;\n        this.moveHandler && this.moveHandler(event, this);\n    }\n\n    private onTouchEnd(event: cc.Event.EventTouch): void {\n        this.endHandler && this.endHandler(event, this);\n    }\n\n    private onTouchCancel(event: cc.Event.EventTouch): void {\n        this.cancelHander && this.cancelHander(event, this);\n    }\n\n    /** 拖动状态 */\n    public setDragState(state: MoveState) {\n    }\n}"]}